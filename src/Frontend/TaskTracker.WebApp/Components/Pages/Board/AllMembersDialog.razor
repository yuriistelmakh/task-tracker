@using TaskTracker.Domain.Enums
<MudDialog TitleClass="pa-0">
    <DialogContent>
        <MudStack Row=true
                  Class="d-flex justify-space-between"
                  AlignItems=@AlignItems.Center>
            <MudText Typo=@Typo.h6>
                <bold>Members</bold>
            </MudText>
            <MudIconButton Icon=@Icons.Material.Filled.Close
                           @onclick=@OnCloseClicked/>
        </MudStack>
        <MudStack Class="pt-2">

            <MudTextField T=string
                          Adornment=@Adornment.Start
                          AdornmentIcon=@Icons.Material.Filled.Search
                          Variant=@Variant.Outlined
                          DebounceInterval=500
                          ValueChanged=FetchMembers
                          Margin=@Margin.Dense
                          Style="width: 100%"
                          Placeholder="Search members..." />
            <MudStack Spacing=2
                      Style="min-height: 250px">
                @foreach (var member in _members)
                {
                    <MudPaper Class="pa-2"
                              Elevation=0
                              Style="border: 1px solid var(--mud-palette-secondary)">

                        <MudGrid Spacing=2>

                            <MudItem xs=6>
                                <MudStack Row=true
                                          AlignItems=@AlignItems.Center>
                                    @if (!string.IsNullOrEmpty(member.AvatarUrl))
                                    {
                                        <MudAvatar Size=@Size.Medium>
                                            <MudImage Src=@member.AvatarUrl
                                                      Alt=@member.DisplayName
                                                      ObjectFit=@ObjectFit.Cover />
                                        </MudAvatar>
                                    }
                                    else
                                    {
                                        <MudIcon Icon=@Icons.Material.Filled.AccountCircle
                                                 Size=@Size.Large />
                                    }
                                    <MudStack Spacing=0>
                                        <MudStack Row=true
                                                  Spacing=1
                                                  AlignItems=@AlignItems.Center>
                                            <MudText>@member.DisplayName</MudText>
                                            @if (member.Role == BoardRole.Owner)
                                            {
                                                <MudTooltip Text="Owner"
                                                            Inline=true
                                                            Arrow=true
                                                            Placement=@Placement.Top>
                                                    <MudIcon Icon=@Icons.Material.Filled.Star
                                                             Size=@Size.Small />
                                                </MudTooltip>
                                            }
                                        </MudStack>
                                        <MudText Typo=@Typo.subtitle2 Color=@Color.Primary>@($"@{member.Tag}")</MudText>
                                    </MudStack>
                                </MudStack>
                            </MudItem>

                            <MudItem xs=6>
                                <MudContainer Class="d-flex justify-end align-center pa-0 pr-2"
                                              Style="height: 100%">
                                    <MudText>@member.Role</MudText>
                                </MudContainer>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                }
            </MudStack>

            @if (_totalMembersPages > 1)
            {
                <MudContainer Class="pa-0 d-flex justify-end">
                    <MudStack AlignItems=@AlignItems.End>
                        <MudPagination Count=@_totalMembersPages
                                       Selected=@_currentMembersPage
                                       SelectedChanged=@OnPageChanged />
                    </MudStack>
                </MudContainer>
            }
            <MudContainer Class="pa-0 mb-2 d-flex justify-end">
                <MudButton Color=@Color.Primary
                           Variant=@Variant.Filled
                           FullWidth=false
                           OnClick=@OnCloseClicked>
                    OK
                </MudButton>
            </MudContainer>
        </MudStack>
    </DialogContent>
</MudDialog>